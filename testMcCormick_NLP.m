%% test McCormick
clear all
x1=sdpvar(1,1,'full');
x2=sdpvar(1,1,'full');
x3=sdpvar(1,1,'full');
x4=sdpvar(1,1,'full');
P1=sdpvar(1,1,'full');
P2=sdpvar(1,1,'full');
W=sdpvar(1,1,'full');
Y=sdpvar(1,1,'full');
F=[];
F=F+(0<=x1<=10);
F=F+(0<=x2<=30);
F=F+(0<=x3<=70);
F=F+(0<=x4<=20);
F=F+(Y==x2+x3);
X=sdpvar(1,1,'full');
F=F+(56<=X<=78);
F=F+(X*Y==x2*56+78*x3);
x11=sdpvar(1,1,'full');
x12=sdpvar(1,1,'full');
Y1=sdpvar(1,1,'full');
Y2=sdpvar(1,1,'full');
x41=sdpvar(1,1,'full');
x42=sdpvar(1,1,'full');
F=F+(x11>=0);
F=F+(x12>=0);
F=F+(Y1>=0);
F=F+(Y2>=0);
F=F+(x41>=0);
F=F+(x42>=0);
F=F+(x1==x11+x12);
F=F+(x4==x41+x42);
F=F+(Y==Y1+Y2);
F=F+(P1==x11+x41+Y1);
F=F+(P2==x12+x42+Y2);
RP1=sdpvar(1,1,'full');
RP2=sdpvar(1,1,'full');
F=F+(RP1==45*x11+98*x41+X*Y1);
F=F+(RP2==45*x12+98*x42+X*Y2);
F=F+(RP1>=70*P1);
F=F+(RP2>=85*P2);
OBJ=-1500*x1-1600*x2-2000*x3-2300*x4+2000*P1+2200*P2;
ops=sdpsettings('solver','ipopt');
sol=optimize(F,-OBJ,ops)
[{'x1','x11','x12','x2','x3','x4','x41','x42','P1','P2','X','Y1','Y2','OBJ'};num2cell(value([x1,x11,x12,x2,x3,x4,x41,x42,P1,P2,X,Y1,Y2,OBJ]))]